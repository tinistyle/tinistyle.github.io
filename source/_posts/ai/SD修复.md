---
title: SD 高清修复
date: 2024-02-24 02:57:13
tags:
  - AI绘画
  - SD
categories: AI
---

## 高分辨率修复

文生图使用，本质就是图生图，先生成一个低质量版本，然后用这个版本做一次图生图

优势：
+ 不改变画面构图（种子固定了）
+ 克服直接生成大分辨率图时多人、多头等问题
+ 操作渐变、清晰、直观

劣势：
+ 受显存大小限制
+ 速度较慢
+ 偶尔加戏，添加上额外元素

相关参数：
+ 高分迭代步数：在图生图放大时的迭代步数，为0时表示和初次文生图时一致
+ 重绘幅度：根据算法决定，推荐0.3-0.5
+ 放大算法：
  + Latent系列：细节丰富，但容易导致画面变形，重绘幅度一般不能低于0.5，否则容易出现模糊
  + *GAN系列：保持画面相似，但缺少细节度。拿不准效果时无脑选择R-ESRGAN 4x+，二次元选择带Anime6B的


## SD upscale

图生图脚本中使用。本质是将图片拆成小块重绘，再拼合成一张大图

优势：
+ 可以突破内存限制获得更大分辨率
+ 画面精细度高，细节丰富

劣势：
+ 分割重绘过程不可控（语义误导和分割线割裂）
+ 繁琐不直观
+ 偶尔加戏，出现额外元素

相关参数设置：
+ 图生图的重绘幅度一般不超过0.5，推荐0.2-0.3
+ 放大算法与高清修复一致
+ 分块重叠像素宽度：图块与图块间的重叠部分宽度，使拼合时更自然，如果出现接缝明显可以适当提高

## 局部重绘

使用画笔选择需要重绘的部分，调整重绘幅度和相关参数，并修改提示词。本质是重新图生图，再将重绘区域拼回去

相关参数：
+ 蒙版模式：可以选择重绘蒙版位置还是蒙版外的地方
+ 内容处理：
  + 填充：对原图高度模糊后再进行加噪去噪，重绘效果差异稍大
  + 原版：原样输入进行加噪去噪，重绘效果接近
  + 潜空间噪声：将蒙版区域转化为层纯粹的潜空间噪声再去噪，重绘效果差异最大
+ 重绘区域：
  + 全图：将全图重绘，然后将蒙版区域剪下来拼回去
  + 仅蒙版区域：仅绘制蒙版及周边区域，然后拼回去
+ 预留像素：影响蒙版提取周边区域的大小，类似羽化

## 涂鸦重绘
使用有颜色的画笔标记，重绘时会使用画笔颜色，常用于修改画面中的错误部分

## 涂鸦
使用有颜色的画笔涂抹。重绘整张图

## 蒙版重绘
可以上传黑白蒙版，白色为蒙版，黑色为飞蒙版区域